function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var t=globalThis,n={},a={},i=t.parcelRequire8123;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){a[e]=t},t.parcelRequire8123=i);var o=i.register;o("iL6GR",function(e,t){customElements.define("custom-nav",class extends HTMLElement{connectedCallback(){let e=this.dataset.activeLink;setTimeout(()=>{this.querySelector(`li:nth-child(${e})`).className="navigation__list-item_active"},0),this.innerHTML=`
            <nav class="navigation">
                <ul class="navigation__list">
                    <li>
                        <a class="navigation__link" href="/cp/" title="\u{41A}\u{43E}\u{448}\u{435}\u{43B}\u{435}\u{43A}">
                            <img class="navigation__img" src="${new URL(i("1df7L"))}" alt="\u{41A}\u{43E}\u{448}\u{435}\u{43B}\u{451}\u{43A}">
                        </a>
                    </li>
                    <li>
                        <a class="navigation__link" href="/cp/transactions" title="\u{422}\u{440}\u{430}\u{43D}\u{437}\u{430}\u{43A}\u{446}\u{438}\u{438}">
                            <img class="navigation__img" src="${new URL(i("6Vp7X"))}" alt="\u{411}\u{443}\u{445}\u{433}\u{430}\u{43B}\u{442}\u{435}\u{440}\u{441}\u{43A}\u{430}\u{44F} \u{43A}\u{43D}\u{438}\u{433}\u{430}">
                        </a>
                    </li>
                    <li>
                        <a class="navigation__link" href="/cp/realizedPnL" title="\u{420}\u{435}\u{430}\u{43B}\u{438}\u{437}\u{43E}\u{432}\u{430}\u{43D}\u{43D}\u{44B}\u{439} PnL">
                            <img class="navigation__img" src="${new URL(i("imq0f"))}" alt="\u{420}\u{443}\u{43A}\u{430} \u{441} \u{43C}\u{435}\u{448}\u{435}\u{447}\u{43A}\u{43E}\u{43C} \u{434}\u{43B}\u{44F} \u{434}\u{435}\u{43D}\u{435}\u{433}">
                        </a>
                    </li>
                    <li>
                        <a class="navigation__link" href="/cp/unrealizedPnL" title="\u{41D}\u{435}\u{440}\u{435}\u{430}\u{43B}\u{438}\u{437}\u{43E}\u{432}\u{430}\u{43D}\u{43D}\u{44B}\u{439} PnL">
                            <img class="navigation__img" src="${new URL(i("3BkXQ"))}" alt="\u{413}\u{438}\u{441}\u{442}\u{43E}\u{433}\u{440}\u{430}\u{43C}\u{43C}\u{430}">
                        </a>
                    </li>
                </ul>
            </nav>
        `}})}),o("1df7L",function(e,t){e.exports=import.meta.resolve("JhyDX")}),o("6Vp7X",function(e,t){e.exports=import.meta.resolve("5IJ5w")}),o("imq0f",function(e,t){e.exports=import.meta.resolve("i5U7f")}),o("3BkXQ",function(e,t){e.exports=import.meta.resolve("caGxo")}),o("lXqOp",function(t,n){e(t.exports,"makeFuncOpenModalWindow",()=>a);function a(e,{action:t}){return()=>{e.dataset.action=t,e.showModal()}}}),o("3KRaD",function(t,n){e(t.exports,"makeHandlerOpenModal",()=>o);var a=i("lXqOp");function o(e,t){return n=>{n.target.closest(".edit-btn")&&(0,a.makeFuncOpenModalWindow)(e,t)()}}}),o("du2jG",function(t,n){e(t.exports,"makeFuncFillModal",()=>a);function a({modalClassName:e,rowTableClassName:t,cellsClassNames:n}){return a=>{let i=a.target;if(!i.closest(".edit-btn"))return;let o=i.closest("."+t),u=o.dataset.id,r=[document.createTextNode(u),...n.map(e=>o.querySelector(`.${e}`))];document.querySelector("."+e).querySelectorAll("*[name]").forEach((e,t)=>{if("datetime-local"===e.type){e.value=r[t].dateTime;return}if("number"===e.type){e.value=r[t].textContent.replace(",",".");return}e.value=r[t].textContent})}}}),o("bgTL1",function(t,n){e(t.exports,"modal",()=>a),e(t.exports,"modalFields",()=>i),e(t.exports,"saveBtn",()=>o);let a=document.querySelector(".modal"),i=[...a.querySelectorAll("*[name]")],o=a.querySelector(".modal-btn_ok");a.addEventListener("input",()=>{i.filter(e=>"id"!==e.name&&"total"!==e.name).every(e=>{if("number"===e.type&&0>=+e.value)return!1;if("pair"===e.name){let t=e.value.split("/");return 2===t.length&&t[0].length&&t[1].length}return!!e.value})?o.removeAttribute("disabled"):o.setAttribute("disabled",!0)}),a.addEventListener("close",()=>{a.dataset.action="",i.forEach(e=>e.value=""),o.setAttribute("disabled",!0)})}),o("aKRUb",function(t,n){e(t.exports,"updateRow",()=>a);function a(e,t){for(let[n,a]of Object.entries(t))e.dataset[n]=a;e.dataset.timeUpdate=Date.now()}}),o("fJadv",function(t,n){e(t.exports,"renderRows",()=>a);function a(e,t,n){let a=[];t.forEach(e=>a.push(n(e))),e.append(...a)}}),o("lT6Ry",function(t,n){e(t.exports,"collectData",()=>a);function a(e,...t){return[...e].reduce((e,n)=>{if(t.includes(n.name))return e;let a="number"===n.type?+n.value:n.value.trim();return"pair"===n.id&&(a=n.value.toLowerCase()),a&&(e[n.name]=a),e},{})}}),o("7SWjB",function(t,n){function a(e=()=>console.log("Соединение с БД установлено")){let t=indexedDB.open("cp");t.onupgradeneeded=function(e){let t=e.target.result;t.createObjectStore("wallet",{keyPath:"id",autoIncrement:!0}).createIndex("coinIdx","coin",{unique:!0}),t.createObjectStore("transactions",{keyPath:"id",autoIncrement:!0}).createIndex("coinIdx","pair")},t.onsuccess=e,t.onerror=function(e){console.error("Error",e.target.error)}}function i(e,t){return n=>{o(n,e,"readonly").getAll().onsuccess=e=>{t(e.target.result)}}}function o(e,t,n){return e.target.result.transaction(t,n).objectStore(t)}e(t.exports,"connectDB",()=>a),e(t.exports,"makeReadAllRecords",()=>i),e(t.exports,"startTransaction",()=>o)}),o("iFviF",function(e,t){e.exports=import.meta.resolve("8ksLu")}),o("d69wW",function(e,t){e.exports=import.meta.resolve("cm9mC")}),o("cEcEw",function(e,t){(document.querySelector(".coins")||document.querySelector(".transactions")).addEventListener("click",function(e){e.target.closest(".delete-btn")&&(e.target.closest(".coins__record")||e.target.closest(".transactions__record")).remove()})}),i("iL6GR");var u=i("lXqOp");let r=document.querySelector(".deposit"),c=document.querySelector(".new-coin-modal");r.addEventListener("click",(0,u.makeFuncOpenModalWindow)(c,{action:"add"}));var s=i("3KRaD"),l=i("du2jG");let d=document.querySelector(".coins"),m=document.querySelector(".new-coin-modal");d.addEventListener("click",(0,s.makeHandlerOpenModal)(m,{action:"edit"})),d.addEventListener("click",(0,l.makeFuncFillModal)({modalClassName:"new-coin-modal",rowTableClassName:"coins__record",cellsClassNames:["coins__coin","coins__amount"]}));var p=i("bgTL1"),v=i("aKRUb"),h=i("fJadv"),f=i("lT6Ry"),_=i("7SWjB");class g extends HTMLTableRowElement{priceRequest;totalPrice;constructor(e={},t=!1){super(),this.requiredSaveToDb=t,this.setAttribute("is","custom-tr"),this.className="coins__record";let{coin:n,amount:a,id:i}=e,{dataset:o}=this;o.id=i||o.id||"",o.coin=n||o.coin||"",o.amount=a||o.amount||"",o.timeUpdate=Date.now(),this.priceRequest=this.getPrice(o.coin),this.priceRequest.then(e=>(this.totalPrice=+(o.amount*e).toFixed(2),e))}async connectedCallback(){this.requiredSaveToDb&&this.saveData(),this.priceRequest.then(this.renderPriceAndTotalPrice).then(()=>document.dispatchEvent(new CustomEvent("coin-added",{detail:{totalPrice:this.totalPrice}})));let{coin:e,amount:t}=this.dataset;this.innerHTML=`
            <td class="coins__btn">
                <button class="small-btn delete-btn" title="\u{423}\u{434}\u{430}\u{43B}\u{438}\u{442}\u{44C}">
                    <img src="${new URL(i("iFviF"))}" alt="\u{41A}\u{43E}\u{440}\u{437}\u{438}\u{43D}\u{430}">
                </button>
            </td>
            <td class="coins__coin">${e}</td>
            <td class="coins__amount">${t}</td>
            <td class="coins__price"></td>
            <td class="coins__total-price"></td>
            <td class="coins__btn">
                <button class="small-btn edit-btn" title="\u{420}\u{435}\u{434}\u{430}\u{43A}\u{442}\u{438}\u{440}\u{43E}\u{432}\u{430}\u{442}\u{44C}">
                    <img src="${new URL(i("d69wW"))}" alt="\u{420}\u{443}\u{447}\u{43A}\u{430} \u{43F}\u{435}\u{440}\u{44C}\u{435}\u{432}\u{430}\u{44F}">
                </button>
            </td>
        `}disconnectedCallback(){let{id:e}=this.dataset;(0,_.connectDB)(t=>{(0,_.startTransaction)(t,"wallet","readwrite").delete(+e)}),document.dispatchEvent(new CustomEvent("coin-deleted",{detail:{totalPrice:this.totalPrice}}))}static get observedAttributes(){return["data-time-update"]}attributeChangedCallback(e,t,n){if(null===t)return;let{coin:a,amount:i}=this.dataset,o=this.querySelector(".coins__coin"),u=this.querySelector(".coins__amount");o.textContent=a,u.textContent=i,this.priceRequest=this.getPrice(a),this.priceRequest.then(e=>{let t=+(e*this.dataset.amount).toFixed(2),n=t-this.totalPrice;this.totalPrice=t,document.dispatchEvent(new CustomEvent("coin-changed",{detail:{delta:n}}))}),this.priceRequest.then(this.renderPriceAndTotalPrice),this.saveData(),this.style.animation="backlight 3s",setTimeout(()=>this.style.animation="",3e3)}saveData(){let{id:e,coin:t,amount:n}=this.dataset,a={coin:t.toLowerCase(),amount:+n};e&&(a.id=+e);let i=e=>{let t=(0,_.startTransaction)(e,"wallet","readwrite").put(a);t.onsuccess=e=>{let t=e.target.result;this.dataset.id=t},t.onerror=()=>{this.remove(),(0,_.startTransaction)(e,"wallet","readwrite").index("coinIdx").get(a.coin).onsuccess=e=>{let t=e.target.result;if(t){a.id=+t.id,a.amount=t.amount+a.amount;let e=document.querySelector(`.coins__record[data-id="${a.id}"]`);e.dataset.amount=a.amount,e.dataset.timeUpdate=Date.now()}}}};(0,_.connectDB)(i)}getPrice(e){return"usdt"===e?Promise.resolve(1):fetch(`https://api.binance.com/api/v1/klines?symbol=${e?.toUpperCase()}USDT&interval=1d&limit=1`).then(e=>e.json()).then(e=>+parseFloat(e[0][4]).toFixed(2))}renderPriceAndTotalPrice=e=>{this.querySelector(".coins__price").textContent=e,this.querySelector(".coins__total-price").textContent=this.totalPrice}}customElements.define("custom-tr",g,{extends:"tr"});let x=document.querySelector(".coins");p.saveBtn.addEventListener("click",()=>{var e;let t;(e=p.modal.dataset.action,t=(0,f.collectData)(p.modalFields),({add:()=>(0,h.renderRows)(x,[t],e=>new g(e,!0)),edit:()=>(0,v.updateRow)(x.querySelector(`.coins__record[data-id="${t.id}"]`),t)})[e])(),p.modal.close()}),i("cEcEw");var _=i("7SWjB"),h=i("fJadv");let b=document.querySelector(".coins");(0,_.connectDB)((0,_.makeReadAllRecords)("wallet",e=>(0,h.renderRows)(b,e,e=>new g(e)))),document.addEventListener("coin-added",function(e){let{totalPrice:t}=e.detail,n=+w.textContent;w.textContent=(n+t).toFixed(2)}),document.addEventListener("coin-changed",function(e){w.textContent=(+w.textContent+e.detail.delta).toFixed(2)}),document.addEventListener("coin-deleted",function(e){w.textContent=(w.textContent-e.detail.totalPrice).toFixed(2)});let w=document.querySelector(".balance__value");