function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var t=globalThis,n={},a={},o=t.parcelRequire8123;null==o&&((o=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var o={id:e,exports:{}};return n[e]=o,t.call(o.exports,o,o.exports),o.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},t.parcelRequire8123=o);var i=o.register;i("iL6GR",function(e,t){customElements.define("custom-nav",class extends HTMLElement{connectedCallback(){let e=this.dataset.activeLink;setTimeout(()=>{this.querySelector(`li:nth-child(${e})`).className="navigation__list-item_active"},0),this.innerHTML=`
            <nav class="navigation">
                <ul class="navigation__list">
                    <li>
                        <a class="navigation__link" href="/" title="\u{41A}\u{43E}\u{448}\u{435}\u{43B}\u{435}\u{43A}">
                            <img class="navigation__img" src="${new URL(o("8sXdA"))}" alt="\u{41A}\u{43E}\u{448}\u{435}\u{43B}\u{451}\u{43A}">
                        </a>
                    </li>
                    <li>
                        <a class="navigation__link" href="/transactions" title="\u{422}\u{440}\u{430}\u{43D}\u{437}\u{430}\u{43A}\u{446}\u{438}\u{438}">
                            <img class="navigation__img" src="${new URL(o("4LmI1"))}" alt="\u{411}\u{443}\u{445}\u{433}\u{430}\u{43B}\u{442}\u{435}\u{440}\u{441}\u{43A}\u{430}\u{44F} \u{43A}\u{43D}\u{438}\u{433}\u{430}">
                        </a>
                    </li>
                    <li>
                        <a class="navigation__link" href="/realizedPnL" title="\u{420}\u{435}\u{430}\u{43B}\u{438}\u{437}\u{43E}\u{432}\u{430}\u{43D}\u{43D}\u{44B}\u{439} PnL">
                            <img class="navigation__img" src="${new URL(o("7MWLU"))}" alt="\u{420}\u{443}\u{43A}\u{430} \u{441} \u{43C}\u{435}\u{448}\u{435}\u{447}\u{43A}\u{43E}\u{43C} \u{434}\u{43B}\u{44F} \u{434}\u{435}\u{43D}\u{435}\u{433}">
                        </a>
                    </li>
                    <li>
                        <a class="navigation__link" href="/unrealizedPnL" title="\u{41D}\u{435}\u{440}\u{435}\u{430}\u{43B}\u{438}\u{437}\u{43E}\u{432}\u{430}\u{43D}\u{43D}\u{44B}\u{439} PnL">
                            <img class="navigation__img" src="${new URL(o("i0GDG"))}" alt="\u{413}\u{438}\u{441}\u{442}\u{43E}\u{433}\u{440}\u{430}\u{43C}\u{43C}\u{430}">
                        </a>
                    </li>
                </ul>
            </nav>`}})}),i("8sXdA",function(e,t){e.exports=import.meta.resolve("gMJVE")}),i("4LmI1",function(e,t){e.exports=import.meta.resolve("2NdMt")}),i("7MWLU",function(e,t){e.exports=import.meta.resolve("gW5Z3")}),i("i0GDG",function(e,t){e.exports=import.meta.resolve("8odM1")}),i("lXqOp",function(t,n){e(t.exports,"makeFuncOpenModalWindow",()=>a);function a(e,{action:t}){return()=>{e.dataset.action=t,e.showModal()}}}),i("3KRaD",function(t,n){e(t.exports,"makeHandlerOpenModal",()=>i);var a=o("lXqOp");function i(e,t){return n=>{n.target.closest(".edit-btn")&&(0,a.makeFuncOpenModalWindow)(e,t)()}}}),i("du2jG",function(t,n){e(t.exports,"makeFuncFillModal",()=>a);function a({modalClassName:e,rowTableClassName:t,cellsClassNames:n}){return a=>{let o=a.target;if(!o.closest(".edit-btn"))return;let i=o.closest("."+t),u=i.dataset.id,r=[document.createTextNode(u),...n.map(e=>i.querySelector(`.${e}`))];document.querySelector("."+e).querySelectorAll("*[name]").forEach((e,t)=>{if("datetime-local"===e.type){e.value=r[t].dateTime;return}if("number"===e.type){e.value=r[t].textContent.replace(",",".");return}e.value=r[t].textContent})}}}),i("bgTL1",function(t,n){e(t.exports,"modal",()=>a),e(t.exports,"modalFields",()=>o),e(t.exports,"saveBtn",()=>i);let a=document.querySelector(".modal"),o=[...a.querySelectorAll("*[name]")],i=a.querySelector(".modal-btn_ok");a.addEventListener("input",()=>{o.filter(e=>"id"!==e.name&&"total"!==e.name).every(e=>!("number"===e.type&&0>=+e.value)&&!!e.value)?i.removeAttribute("disabled"):i.setAttribute("disabled",!0)}),a.addEventListener("close",()=>{a.dataset.action="",o.forEach(e=>e.value=""),i.setAttribute("disabled",!0)})}),i("aKRUb",function(t,n){e(t.exports,"updateRow",()=>a);function a(e,t){for(let[n,a]of Object.entries(t))e.dataset[n]=a;e.dataset.timeUpdate=Date.now()}}),i("fJadv",function(t,n){e(t.exports,"renderRows",()=>a);function a(e,t,n){let a=[];t.forEach(e=>a.push(n(e))),e.append(...a)}}),i("lT6Ry",function(t,n){e(t.exports,"collectData",()=>a);function a(e,...t){return[...e].reduce((e,n)=>{if(t.includes(n.name))return e;let a="number"===n.type?+n.value:n.value.trim();return"pair"===n.id&&(a=n.value.toLowerCase()),a&&(e[n.name]=a),e},{})}}),i("7SWjB",function(t,n){function a(e=()=>console.log("Соединение с БД установлено")){let t=indexedDB.open("cp");t.onupgradeneeded=function(e){let t=e.target.result;t.createObjectStore("wallet",{keyPath:"id",autoIncrement:!0}).createIndex("coinIdx","coin",{unique:!0}),t.createObjectStore("transactions",{keyPath:"id",autoIncrement:!0}).createIndex("coinIdx","pair")},t.onsuccess=e,t.onerror=function(e){console.error("Error",e.target.error)}}function o(e,t){return n=>{i(n,e,"readonly").getAll().onsuccess=e=>{t(e.target.result)}}}function i(e,t,n){return e.target.result.transaction(t,n).objectStore(t)}e(t.exports,"connectDB",()=>a),e(t.exports,"makeReadAllRecords",()=>o),e(t.exports,"startTransaction",()=>i)}),i("dDpgc",function(e,t){e.exports=import.meta.resolve("9Ynn1")}),i("VqXQz",function(e,t){e.exports=import.meta.resolve("b7y8n")}),i("cEcEw",function(e,t){(document.querySelector(".coins")||document.querySelector(".transactions")).addEventListener("click",function(e){e.target.closest(".delete-btn")&&(e.target.closest(".coins__record")||e.target.closest(".transactions__record")).remove()})}),o("iL6GR");var u=o("lXqOp");let r=document.querySelector(".deposit"),c=document.querySelector(".new-coin-modal");r.addEventListener("click",(0,u.makeFuncOpenModalWindow)(c,{action:"add"}));var s=o("3KRaD"),l=o("du2jG");let d=document.querySelector(".coins"),m=document.querySelector(".new-coin-modal");d.addEventListener("click",(0,s.makeHandlerOpenModal)(m,{action:"edit"})),d.addEventListener("click",(0,l.makeFuncFillModal)({modalClassName:"new-coin-modal",rowTableClassName:"coins__record",cellsClassNames:["coins__coin","coins__amount"]}));var p=o("bgTL1"),v=o("aKRUb"),h=o("fJadv"),_=o("lT6Ry"),f=o("7SWjB");class g extends HTMLTableRowElement{priceRequest;totalPrice;constructor(e={},t=!1){super(),this.requiredSaveToDb=t,this.setAttribute("is","custom-tr"),this.className="coins__record";let{coin:n,amount:a,id:o}=e,{dataset:i}=this;i.id=o||i.id||"",i.coin=n||i.coin||"",i.amount=a||i.amount||"",i.timeUpdate=Date.now(),this.priceRequest=this.getPrice(i.coin),this.priceRequest.then(e=>(this.totalPrice=+(i.amount*e).toFixed(2),e))}async connectedCallback(){this.requiredSaveToDb&&this.saveData(),this.priceRequest.then(this.renderPriceAndTotalPrice).then(()=>document.dispatchEvent(new CustomEvent("coin-added",{detail:{totalPrice:this.totalPrice}})));let{coin:e,amount:t}=this.dataset;this.innerHTML=`
            <td class="coins__btn">
                <button class="small-btn delete-btn" title="\u{423}\u{434}\u{430}\u{43B}\u{438}\u{442}\u{44C}">
                    <img src="${new URL(o("dDpgc"))}" alt="\u{41A}\u{43E}\u{440}\u{437}\u{438}\u{43D}\u{430}">
                </button>
            </td>
            <td class="coins__coin">${e}</td>
            <td class="coins__amount">${t}</td>
            <td class="coins__price"></td>
            <td class="coins__total-price"></td>
            <td class="coins__btn">
                <button class="small-btn edit-btn" title="\u{420}\u{435}\u{434}\u{430}\u{43A}\u{442}\u{438}\u{440}\u{43E}\u{432}\u{430}\u{442}\u{44C}">
                    <img src="${new URL(o("VqXQz"))}" alt="\u{420}\u{443}\u{447}\u{43A}\u{430} \u{43F}\u{435}\u{440}\u{44C}\u{435}\u{432}\u{430}\u{44F}">
                </button>
            </td>
        `}disconnectedCallback(){let{id:e}=this.dataset;(0,f.connectDB)(t=>{(0,f.startTransaction)(t,"wallet","readwrite").delete(+e)}),document.dispatchEvent(new CustomEvent("coin-deleted",{detail:{totalPrice:this.totalPrice}}))}static get observedAttributes(){return["data-time-update"]}attributeChangedCallback(e,t,n){if(null===t)return;let{coin:a,amount:o}=this.dataset,i=this.querySelector(".coins__coin"),u=this.querySelector(".coins__amount");i.textContent=a,u.textContent=o,this.priceRequest=this.getPrice(a),this.priceRequest.then(e=>{let t=+(e*this.dataset.amount).toFixed(2),n=t-this.totalPrice;this.totalPrice=t,document.dispatchEvent(new CustomEvent("coin-changed",{detail:{delta:n}}))}),this.priceRequest.then(this.renderPriceAndTotalPrice),this.saveData(),this.style.animation="backlight 3s",setTimeout(()=>this.style.animation="",3e3)}saveData(){let{id:e,coin:t,amount:n}=this.dataset,a={coin:t.toLowerCase(),amount:+n};e&&(a.id=+e);let o=e=>{let t=(0,f.startTransaction)(e,"wallet","readwrite").put(a);t.onsuccess=e=>{let t=e.target.result;this.dataset.id=t},t.onerror=()=>{this.remove(),(0,f.startTransaction)(e,"wallet","readwrite").index("coinIdx").get(a.coin).onsuccess=e=>{let t=e.target.result;if(t){a.id=+t.id,a.amount=t.amount+a.amount;let e=document.querySelector(`.coins__record[data-id="${a.id}"]`);e.dataset.amount=a.amount,e.dataset.timeUpdate=Date.now()}}}};(0,f.connectDB)(o)}getPrice(e){return"usdt"===e?Promise.resolve(1):fetch(`https://api.binance.com/api/v1/klines?symbol=${e?.toUpperCase()}USDT&interval=1d&limit=1`).then(e=>e.json()).then(e=>+parseFloat(e[0][4]).toFixed(2))}renderPriceAndTotalPrice=e=>{this.querySelector(".coins__price").textContent=e,this.querySelector(".coins__total-price").textContent=this.totalPrice}}customElements.define("custom-tr",g,{extends:"tr"});let b=document.querySelector(".coins");p.saveBtn.addEventListener("click",()=>{var e;let t;(e=p.modal.dataset.action,t=(0,_.collectData)(p.modalFields),({add:()=>(0,h.renderRows)(b,[t],e=>new g(e,!0)),edit:()=>(0,v.updateRow)(b.querySelector(`.coins__record[data-id="${t.id}"]`),t)})[e])(),p.modal.close()}),o("cEcEw");var f=o("7SWjB"),h=o("fJadv");let x=document.querySelector(".coins");(0,f.connectDB)((0,f.makeReadAllRecords)("wallet",e=>(0,h.renderRows)(x,e,e=>new g(e)))),document.addEventListener("coin-added",function(e){let{totalPrice:t}=e.detail,n=+w.textContent;w.textContent=(n+t).toFixed(2)}),document.addEventListener("coin-changed",function(e){w.textContent=(+w.textContent+e.detail.delta).toFixed(2)}),document.addEventListener("coin-deleted",function(e){w.textContent=(w.textContent-e.detail.totalPrice).toFixed(2)});let w=document.querySelector(".balance__value");